<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador de Densidades</title>
  <link rel="stylesheet" href="/static/styles/style.css">
</head>

<body>

  <div class="encabezado text-center">
    <img src="/static/recursos/lapiz.png" alt="Logo" class="logo">
    <h1 style="text-align: center;">Simulador de Densidades</h1>
  </div>

  <div class="container">
    
    <nav class="sidebar">
      <div class="sidebar-title">Distribuciones</div>
      <button class="nav-item active" data-distribution="bernoulli">Bernoulli</button>
      <button class="nav-item" data-distribution="binomial">Binomial</button>
      <button class="nav-item" data-distribution="multinomial">Multinomial</button>
      <button class="nav-item" data-distribution="exponencial">Exponencial</button>
      <button class="nav-item" data-distribution="normal">Normal</button>
      <button class="nav-item" data-distribution="gibbs">M√©todo de Gibbs</button>
      <button class="nav-item" data-distribution="normal-bivariada">Normal Bivariada</button>
      <button class="nav-item" data-distribution="markov-chain" onclick="setupMarkovChain()">Cadenas de Markov</button>
      <button class="nav-item" data-distribution="metropolis" onclick="setupMetropolisHastings()">Metropolis-Hastings</button>
      <!-- <br> -->
      <!-- <div class="sidebar-title">Lematizadores</div> -->
      <!-- <button class="nav-item" data-distribution="lematizador">Dematizador  </button> -->
    </nav>

    <div class="main-content">
      <div class="simulation-panel">
        <h2 class="panel-title" id="panelTitle">Distribuci√≥n de Bernoulli</h2>

        <div class="distribution-content active" id="bernoulli">
          <div class="inputs-section">
            <div class="input-group">
              <label for="bernoulli-p">Probabilidad de √©xito (p) (0-1):</label>
              <input type="number" id="bernoulli-p" min="0" max="1" step="0.01" value="0.5">
            </div>
            <div class="input-group">
              <label for="bernoulli-n">N√∫mero de simulaciones:</label>
              <input type="number" id="bernoulli-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="binomial">
          <div class="inputs-section">
            <div class="input-group">
              <label for="binomial-n">N√∫mero de ensayos (n):</label>
              <input type="number" id="binomial-n" min="1" value="10">
            </div>
            <div class="input-group">
              <label for="binomial-p">Probabilidad de √©xito (p):</label>
              <input type="number" id="binomial-p" min="0" max="1" step="0.01" value="0.5">
            </div>
            <div class="input-group">
              <label for="binomial-sims">N√∫mero de simulaciones:</label>
              <input type="number" id="binomial-sims" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        
          <!-- Contenido para Multinomial -->
        <div class="distribution-content" id="multinomial">
          
          <div class="tabs">
            <button class="tab-button active" onclick="cambiarTab('simulacion')">Simulaci√≥n Basica</button>
            <button class="tab-button" onclick="cambiarTab('probabilidad')">Distribucion Multinomial</button>
          </div>
          
          <div id="simulacion" class="tab-content active">
            <div class="main-grid">
              <div class="inputs-section">
                <div class="panel-title">Par√°metros de Simulaci√≥n</div>
                
                <div class="section">
                  <div class="input-group">
                    <label>N√∫mero de Experimentos</label>
                    <input type="number" id="n_experimentos" value="5000" min="1">
                  </div>
                </div>

                <div class="section">
                  <div class="section-header">Categor√≠as y Probabilidades</div>
                  <div id="categories-container">
                    <div class="category-item" data-index="0">
                      <div class="category-header">
                        <span class="category-name">üî¥ Categoria 1</span>
                        <button class="remove-btn" onclick="removeCategory(0)">‚úï</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Rojo">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.5" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                    <div class="category-item" data-index="1">
                      <div class="category-header">
                        <span class="category-name">üü¢ Categoria 2</span>
                        <button class="remove-btn" onclick="removeCategory(1)">‚úï</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Verde">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.3" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                    <div class="category-item" data-index="2">
                      <div class="category-header">
                        <span class="category-name">üîµ Categoria 3</span>
                        <button class="remove-btn" onclick="removeCategory(2)">‚úï</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Azul">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.2" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="prob-sum-warning" class="prob-warning" style="display:none"></div>
                  <button class="add-category-btn" onclick="addCategory()">+ A√±adir Categor√≠a</button>
                </div>

                <button class="simulate-btn" onclick="simularMultinomial()">
                  üöÄ Ejecutar Simulaci√≥n
                </button>
              </div>

              <div class="panel results-panel">
                <div class="panel-title">üìà Resultados</div>
                <div id="placeholder-sim" class="placeholder">
                  Configure los par√°metros y presione "Ejecutar Simulaci√≥n"
                </div>
                <div id="resultados-sim" class="hidden"></div>
              </div>
            </div>
          </div>  

        <!-- TAB PROBABILIDAD -->
    <div id="probabilidad" class="tab-content">
      <div class="main-grid">
        <div class="inputs-section">
          <div class="panel-title">Configuraci√≥n del C√°lculo</div>
          
          <div class="section">
            <div class="input-group">
              <label>N√∫mero Total de Experimentos (n)</label>
              <input type="number" id="n_exp_prob" value="10" min="1">
            </div>
          </div>

          <div class="section">
            <div class="section-header">Configuraci√≥n de Categor√≠as</div>
            <div id="categories-prob-container">
              <div class="category-item" data-index="0">
                <div class="category-header">
                  <span class="category-name">Categor√≠a 1</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">‚úï</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.3" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="3" min="0">
                  </div>
                </div>
              </div>
              <div class="category-item" data-index="1">
                <div class="category-header">
                  <span class="category-name">Categor√≠a 2</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">‚úï</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.5" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="5" min="0">
                  </div>
                </div>
              </div>
              <div class="category-item" data-index="2">
                <div class="category-header">
                  <span class="category-name">Categor√≠a 2</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">‚úï</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.2" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="2" min="0">
                  </div>
                </div>
              </div>
            </div>
            <div id="prob-sum-warning-2" class="prob-warning" style="display:none"></div>
            <button class="add-category-btn" onclick="addCategoryProb()">+ A√±adir Categor√≠a</button>
          </div>

          <button class="simulate-btn" onclick="calcularProbabilidad()">
            üßÆ Calcular Probabilidad
          </button>
          <button class="simulate-btn" style="background: linear-gradient(135deg, #27ae60, #229954); margin-top: 0.5rem;" onclick="verificarSimulacion()">
            ‚úì Verificar con Simulaci√≥n
          </button>
        </div>


        <div class="panel results-panel">
          <div class="panel-title">üéØ Resultados del C√°lculo</div>
          <div id="placeholder-prob" class="placeholder">
            Configure los par√°metros y presione "Calcular Probabilidad"
          </div>
          <div id="resultados-prob" class="hidden"></div>
        </div>
      </div>
    </div>
        </div>
        
      
    

        <!-- Contenido para Exponencial -->
        <div class="distribution-content" id="exponencial">
          <div class="inputs-section">
            <div class="input-group">
              <label for="exponencial-lambda">Par√°metro Œª (tasa):</label>
              <input type="number" id="exponencial-lambda" min="0.01" step="0.01" value="1">
            </div>
            <div class="input-group">
              <label for="exponencial-n">N√∫mero de simulaciones:</label>
              <input type="number" id="exponencial-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="normal">
          <div class="inputs-section">
            <div class="input-group">
              <label for="normal-mu">Media (Œº):</label>
              <input type="number" id="normal-mu" step="0.01" value="0">
            </div>
            <div class="input-group">
              <label for="normal-sigma">Desviaci√≥n est√°ndar (œÉ):</label>
              <input type="number" id="normal-sigma" min="0.01" step="0.01" value="1">
            </div>
            <div class="input-group">
              <label for="normal-n">N√∫mero de simulaciones:</label>
              <input type="number" id="normal-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="gibbs">
          <div class="inputs-section">
            <div class="input-group">
              <label for="gibbs-function-select">Selecciona una funci√≥n de densidad f(x, y):</label>
              <select id="gibbs-function-select" class="input-group input"></select>
            </div>

            <div class="input-group">
                <label>L√≠mites del Dominio (No editables):</label>
                <div class="bounds-display-grid">
                    <div>
                        <span>X M√≠n:</span>
                        <code id="gibbs-bound-xmin">0</code>
                    </div>
                    <div>
                        <span>X M√°x:</span>
                        <code id="gibbs-bound-xmax">0</code>
                    </div>
                    <div>
                        <span>Y M√≠n:</span>
                        <code id="gibbs-bound-ymin">0</code>
                    </div>
                    <div>
                        <span>Y M√°x:</span>
                        <code id="gibbs-bound-ymax">0</code>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>Valores iniciales (opcional):</label>
                <div class="bounds-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <input type="number" id="gibbs-x-initial" placeholder="x inicial (auto)">
                    <input type="number" id="gibbs-y-initial" placeholder="y inicial (auto)">
                </div>
            </div>

            <div class="bounds-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="input-group">
                    <label for="gibbs-n-samples">N√∫mero de muestras:</label>
                    <input type="number" id="gibbs-n-samples" value="2000" min="100">
                </div>
                <div class="input-group">
                    <label for="gibbs-burn-in">Burn-in:</label>
                    <input type="number" id="gibbs-burn-in" value="500" min="0">
                </div>
            </div>
            
            <div id="gibbs-status" style="margin-top: 1rem;"></div>
          </div>

          <div class="buttons-section">
            <button class="btn-primary" id="gibbs-validate-btn">üîç Validar</button>
            <button class="btn-primary" id="gibbs-sample-btn" disabled>Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="normal-bivariada">
          <div class="inputs-section">
            <div class="input-group"><label for="bivariada-mu-x">Media X (Œº‚Çì):</label><input type="number" id="bivariada-mu-x" step="0.1" value="0"></div>
            <div class="input-group"><label for="bivariada-mu-y">Media Y (Œº·µß):</label><input type="number" id="bivariada-mu-y" step="0.1" value="0"></div>
            <div class="input-group"><label for="bivariada-sigma-x">Desviaci√≥n X (œÉ‚Çì):</label><input type="number" id="bivariada-sigma-x" min="0.01" step="0.1" value="1"></div>
            <div class="input-group"><label for="bivariada-sigma-y">Desviaci√≥n Y (œÉ·µß):</label><input type="number" id="bivariada-sigma-y" min="0.01" step="0.1" value="1"></div>
            <div class="input-group"><label for="bivariada-rho">Correlaci√≥n (œÅ):</label><input type="number" id="bivariada-rho" min="-1" max="1" step="0.1" value="0.5"></div>
            <div class="input-group"><label for="bivariada-n">N√∫mero de simulaciones:</label><input type="number" id="bivariada-n" min="100" value="2000"></div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="markov-chain">
          <div class="inputs-section">
            <div class="panel-title">‚öôÔ∏è Configurar y Simular Cadena de Markov</div>
            
            <!-- PASO 1: EJEMPLOS -->
            <div class="section">
              <div class="section-header">üìö Paso 1: Seleccionar Ejemplo (Opcional)</div>
              <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">
                Elige un ejemplo predefinido o configura tu propia cadena desde cero
              </p>
              <select id="markov-examples-select" class="markov-select">
                <option value="">-- Configura tu propia cadena --</option>
              </select>
              <button class="btn-secondary" style="margin-top: 0.5rem; width: 100%;" onclick="cargarEjemploMarkov()">
                üì• Cargar Ejemplo Seleccionado
              </button>
              <div id="markov-example-explanation" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(102, 126, 234, 0.1); border-radius: 8px; border-left: 4px solid #667eea;">
                <!-- Se llena din√°micamente -->
              </div>
            </div>

            <!-- PASO 2: DEFINIR ESTADOS -->
            <div class="section">
              <div class="section-header">üî¢ Paso 2: Definir N√∫mero de Estados</div>
              <div class="input-group">
                <label>N√∫mero de Estados (2-6):</label>
                <input type="number" id="markov-n-states" min="2" max="6" value="2" onchange="generarMatrizMarkov()">
              </div>
            </div>

            <!-- PASO 3: NOMBRES DE ESTADOS -->
            <div class="section">
              <div class="section-header">üè∑Ô∏è Paso 3: Nombrar Estados</div>
              <div id="markov-state-names-container">
                <!-- Se genera din√°micamente -->
              </div>
            </div>

            <!-- PASO 4: MATRIZ DE TRANSICI√ìN -->
            <div class="section">
              <div class="section-header">üîÄ Paso 4: Definir Matriz de Transici√≥n</div>
              <div class="markov-matrix-info">
                <p style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">
                  üìù <strong>Instrucciones:</strong> Cada fila representa las probabilidades de transici√≥n DESDE ese estado. La suma de cada fila debe ser 1.0
                </p>
              </div>
              <div id="markov-matrix-container" class="markov-matrix">
                <!-- Se genera din√°micamente -->
              </div>
            </div>

            <!-- PASO 5: PAR√ÅMETROS DE SIMULACI√ìN -->
            <div class="section">
              <div class="section-header">üé≤ Paso 5: Configurar Simulaci√≥n</div>
              
              <div class="input-group">
                <label>Estado Inicial:</label>
                <select id="markov-initial-state" class="markov-select">
                  <option value="">-- Primero configura los estados --</option>
                </select>
                <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap;" id="markov-quick-states">
                  <!-- Botones r√°pidos para seleccionar estado -->
                </div>
              </div>
              
              <div class="input-group">
                <label>N√∫mero de Pasos:</label>
                <input type="number" id="markov-n-steps" min="10" max="10000" value="100">
                <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                  <button class="markov-quick-btn" onclick="document.getElementById('markov-n-steps').value = 50">50 pasos</button>
                  <button class="markov-quick-btn" onclick="document.getElementById('markov-n-steps').value = 100">100 pasos</button>
                  <button class="markov-quick-btn" onclick="document.getElementById('markov-n-steps').value = 500">500 pasos</button>
                  <button class="markov-quick-btn" onclick="document.getElementById('markov-n-steps').value = 1000">1000 pasos</button>
                  <button class="markov-quick-btn" onclick="document.getElementById('markov-n-steps').value = 5000">5000 pasos</button>
                </div>
                <small style="color: #666; margin-top: 0.5rem; display: block;">
                  üí° M√°s pasos = mejor convergencia a la distribuci√≥n estacionaria
                </small>
              </div>
            </div>

            <div id="markov-config-status" style="margin-top: 1rem;"></div>
          </div>

          <!-- BOTONES DE ACCI√ìN -->
          <div class="buttons-section">
            <button class="btn-primary" onclick="ejecutarSimulacionMarkov()">
              üöÄ Configurar y Simular
            </button>
            <button class="btn-secondary" onclick="limpiarMarkov()">
              üîÑ Reiniciar Todo
            </button>
          </div>

          <!-- PANEL DE RESULTADOS (oculto inicialmente) -->
          <div id="markov-results-panel" style="display: none; margin-top: 2rem;">
            <div class="results-divider"></div>
            
            <div class="panel-title" style="margin-top: 2rem;">
              üìä Resultados de la Simulaci√≥n
            </div>

            <div id="markov-simulation-results">
              <!-- Se llena din√°micamente -->
            </div>
          </div>
        </div>

        <div class="distribution-content" id="metropolis">
          <div class="inputs-section">
            <div class="panel-title">üé≤ Algoritmo de Metropolis-Hastings (MCMC)</div>
            
            <div class="metropolis-intro">
              <p style="font-size: 0.95rem; color: #555; line-height: 1.6; margin-bottom: 1rem;">
                <strong>Metropolis-Hastings</strong> es un algoritmo MCMC (Markov Chain Monte Carlo) que permite 
                generar muestras de distribuciones de probabilidad complejas, incluso cuando no podemos muestrear 
                directamente de ellas.
              </p>
              <div class="algo-explanation">
                <div class="algo-title">üîç ¬øC√≥mo funciona?</div>
                <ol style="margin-left: 1.5rem; line-height: 1.8;">
                  <li>Comenzamos en un punto inicial x‚ÇÄ</li>
                  <li>Proponemos un nuevo punto x* usando una <strong>distribuci√≥n de propuesta</strong></li>
                  <li>Calculamos la <strong>raz√≥n de aceptaci√≥n</strong>: Œ± = min(1, P(x*)/P(x_actual))</li>
                  <li>Aceptamos x* con probabilidad Œ±, o mantenemos x_actual</li>
                  <li>Repetimos hasta obtener suficientes muestras</li>
                </ol>
              </div>
            </div>
            
            <!-- PASO 1: EJEMPLOS -->
            <div class="section">
              <div class="section-header">üìö Paso 1: Seleccionar Distribuci√≥n Objetivo (Target)</div>
              <p style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">
                Elige una distribuci√≥n para muestrear o configura tu propia distribuci√≥n
              </p>
              <select id="metropolis-examples-select" class="markov-select">
                <option value="">-- Selecciona un ejemplo --</option>
              </select>
              <button class="btn-secondary" style="margin-top: 0.5rem; width: 100%;" onclick="cargarEjemploMetropolis()">
                üì• Cargar Ejemplo Seleccionado
              </button>
              <div id="metropolis-example-explanation" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(102, 126, 234, 0.1); border-radius: 8px; border-left: 4px solid #667eea;">
                <!-- Se llena din√°micamente -->
              </div>
            </div>

            <!-- PASO 2: PAR√ÅMETROS DE LA DISTRIBUCI√ìN -->
            <div class="section">
              <div class="section-header">‚öôÔ∏è Paso 2: Configurar Par√°metros de la Distribuci√≥n</div>
              <div id="metropolis-params-container">
                <p style="color: #999; font-style: italic;">Primero selecciona un ejemplo...</p>
              </div>
            </div>

            <!-- PASO 3: CONFIGURACI√ìN DEL ALGORITMO -->
            <div class="section">
              <div class="section-header">üéõÔ∏è Paso 3: Configurar Algoritmo MCMC</div>
              
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="input-group">
                  <label>Valor Inicial (x‚ÇÄ):</label>
                  <input type="number" id="metropolis-x-initial" value="0" step="0.1">
                  <small style="color: #666; margin-top: 0.3rem; display: block;">
                    üí° Punto de partida de la cadena
                  </small>
                </div>
                
                <div class="input-group">
                  <label>Desviaci√≥n de Propuesta (œÉ_propuesta):</label>
                  <input type="number" id="metropolis-proposal-sigma" value="1" step="0.1" min="0.01">
                  <small style="color: #666; margin-top: 0.3rem; display: block;">
                    üí° Controla el "tama√±o del salto"
                  </small>
                </div>
              </div>

              <div class="metropolis-tuning-guide" style="background: #fff9e6; padding: 1rem; border-radius: 8px; margin-top: 1rem; border-left: 4px solid #f39c12;">
                <strong>üìñ Gu√≠a de Ajuste:</strong><br>
                ‚Ä¢ œÉ_propuesta <strong>peque√±a</strong> (0.1-0.5): Saltos peque√±os, alta aceptaci√≥n, exploraci√≥n lenta<br>
                ‚Ä¢ œÉ_propuesta <strong>media</strong> (0.5-2): Balance ideal, tasa de aceptaci√≥n ~40-60%<br>
                ‚Ä¢ œÉ_propuesta <strong>grande</strong> (>2): Saltos grandes, baja aceptaci√≥n, puede quedarse atascado
              </div>
              
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                <div class="input-group">
                  <label>N√∫mero de Muestras:</label>
                  <input type="number" id="metropolis-n-samples" value="5000" min="100" max="100000">
                  <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem; flex-wrap: wrap;">
                    <button class="markov-quick-btn" onclick="document.getElementById('metropolis-n-samples').value = 1000">1K</button>
                    <button class="markov-quick-btn" onclick="document.getElementById('metropolis-n-samples').value = 5000">5K</button>
                    <button class="markov-quick-btn" onclick="document.getElementById('metropolis-n-samples').value = 10000">10K</button>
                    <button class="markov-quick-btn" onclick="document.getElementById('metropolis-n-samples').value = 50000">50K</button>
                  </div>
                </div>
                
                <div class="input-group">
                  <label>Burn-in (Descartar):</label>
                  <input type="number" id="metropolis-burn-in" value="1000" min="0">
                  <small style="color: #666; margin-top: 0.3rem; display: block;">
                    üí° Muestras iniciales que se descartan
                  </small>
                </div>
              </div>

              <div class="input-group" style="margin-top: 1rem;">
                <label>Rango de Visualizaci√≥n:</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                  <div>
                    <label style="font-size: 0.9rem; color: #666;">x m√≠n:</label>
                    <input type="number" id="metropolis-x-min" value="-5" step="0.5">
                  </div>
                  <div>
                    <label style="font-size: 0.9rem; color: #666;">x m√°x:</label>
                    <input type="number" id="metropolis-x-max" value="5" step="0.5">
                  </div>
                </div>
              </div>
            </div>

            <div id="metropolis-status" style="margin-top: 1rem;"></div>
          </div>

          <!-- BOTONES DE ACCI√ìN -->
          <div class="buttons-section">
            <button class="btn-primary" onclick="ejecutarMetropolisHastings()">
              üöÄ Ejecutar Simulaci√≥n MCMC
            </button>
            <button class="btn-secondary" onclick="limpiarMetropolis()">
              üîÑ Reiniciar
            </button>
          </div>

          <!-- PANEL DE RESULTADOS -->
          <div id="metropolis-results-panel" style="display: none; margin-top: 2rem;">
            <div class="results-divider"></div>
            
            <div class="panel-title" style="margin-top: 2rem;">
              üìä Resultados de Metropolis-Hastings
            </div>

            <div id="metropolis-simulation-results">
              <!-- Se llena din√°micamente con JavaScript -->
            </div>
          </div>
        </div>

        <div class="distribution-content" id="lematizador">
          <div class="tabs">
            <button class="tab-button active" onclick="cambiarTabLemmatizer('cargar')">üì§ Cargar Corpus</button>
            <button class="tab-button" onclick="cambiarTabLemmatizer('analisis')" id="tab-analisis-btn" disabled>üìä An√°lisis</button>
            <button class="tab-button" onclick="cambiarTabLemmatizer('lematizar')" id="tab-lematizar-btn" disabled>üîç Lematizar</button>
          </div>

          <!-- TAB: CARGAR CORPUS -->
          <div id="cargar-corpus" class="tab-content active">

            <button id="btn-inicializar" class="btn-inicializar" onclick="inicializarLematizador()">üöÄ Inicializar Lematizador</button>
            
            <div class="inputs-section">
              <div class="panel-title">üì§ Cargar Corpus de Texto</div>
              
              <div class="section">
                <div class="upload-area" id="upload-area-lemmatizer">
                  <div class="upload-icon">üìÅ</div>
                  <h3>Arrastra un archivo de texto aqu√≠</h3>
                  <p>o haz clic en el bot√≥n para seleccionar un archivo .txt</p>
                  <input type="file" id="corpus-file-input" accept=".txt" style="display: none;">
                  <button class="btn-primary" type="button" onclick="event.stopPropagation(); document.getElementById('corpus-file-input').click();">
                    Seleccionar Archivo
                  </button>
                </div>
                
                <div id="corpus-preview" style="display: none;">
                  <div class="corpus-info">
                    <div class="info-item">
                      <span class="info-label">Archivo:</span>
                      <span class="info-value" id="corpus-filename">-</span>
                    </div>
                    <div class="info-item">
                      <span class="info-label">Tama√±o:</span>
                      <span class="info-value" id="corpus-size">-</span>
                    </div>
                  </div>
                  
                  <div class="corpus-preview-box">
                    <h4>Vista Previa:</h4>
                    <pre id="corpus-preview-text"></pre>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="buttons-section" id="corpus-buttons" style="display: none;">
              <button class="btn-primary" type="button" onclick="procesarCorpus()">
                üöÄ Procesar Corpus
              </button>
              <button class="btn-secondary" type="button" onclick="limpiarCorpus()">
                üóëÔ∏è Limpiar
              </button>
            </div>
            
            <div id="processing-status" style="display: none; margin-top: 1rem;"></div>
          </div>

          <!-- TAB: AN√ÅLISIS -->
          <div id="analisis-corpus" class="tab-content">
            <div class="panel-title">üìä An√°lisis del Corpus</div>
            
            <div id="analisis-content">
              <div class="stats-grid" id="stats-lemmatizer">
                <!-- Se llenar√° din√°micamente -->
              </div>
              
              <div class="section" style="margin-top: 2rem;">
                <div class="section-header">üìà Palabras M√°s Frecuentes</div>
                <div id="top-words-list" class="words-list">
                  <!-- Se llenar√° din√°micamente -->
                </div>
              </div>
              
              <div class="section" style="margin-top: 2rem;">
                <div class="section-header">üîó Patrones de Sufijos (Cadenas de Markov)</div>
                <div id="suffix-patterns-list">
                  <!-- Se llenar√° din√°micamente -->
                </div>
              </div>
              
              <div class="section" style="margin-top: 2rem;">
                <div class="section-header">üìö Grupos de Lemas</div>
                <div id="lemma-groups-list">
                  <!-- Se llenar√° din√°micamente -->
                </div>
              </div>
              
              <div class="buttons-section" style="margin-top: 2rem;">
                <button class="btn-primary" onclick="descargarAnalisis()">
                  üíæ Descargar An√°lisis (JSON)
                </button>
              </div>
            </div>
          </div>

          <!-- TAB: LEMATIZAR -->
          <div id="lematizar-palabras" class="tab-content">
            <div class="panel-title">üîç Lematizar Palabras</div>
            
            <div class="inputs-section">
              <div class="section">
                <h4 style="margin-bottom: 1rem;">Lematizar Palabra Individual</h4>
                <div class="input-group" style="display: flex; gap: 1rem;">
                  <input 
                    type="text" 
                    id="palabra-input" 
                    placeholder="Escribe una palabra..."
                    style="flex: 1;"
                    onkeypress="if(event.key === 'Enter') lematizarPalabra()"
                  >
                  <button class="btn-primary" onclick="lematizarPalabra()">
                    üîç Analizar
                  </button>
                </div>
              </div>
              
              <div id="resultado-lemma" style="display: none; margin-top: 2rem;">
                <!-- Se llenar√° din√°micamente -->
              </div>
              
              <div class="section" style="margin-top: 2rem;">
                <h4 style="margin-bottom: 1rem;">Lematizar M√∫ltiples Palabras</h4>
                <div class="input-group">
                  <textarea 
                    id="palabras-batch" 
                    placeholder="Escribe varias palabras separadas por espacios o saltos de l√≠nea..."
                    rows="4"
                    style="width: 100%; padding: 0.75rem; border: 2px solid #e1e1e1; border-radius: 8px; font-size: 1rem;"
                  ></textarea>
                </div>
                <button class="btn-primary" onclick="lematizarBatch()" style="margin-top: 1rem;">
                  üöÄ Lematizar Todas
                </button>
              </div>
              
              <div id="resultado-batch" style="display: none; margin-top: 2rem;">
                <!-- Se llenar√° din√°micamente -->
              </div>
            </div>
          </div>
        </div>

        <div id="charts-container">
            <div class="chart-section" id="chart-secondary" style="display: none; height: 400px; margin-bottom: 1rem;"></div>
            <div class="chart-section" id="chart-main" style="min-height: 450px;">
                <div class="chart-placeholder">
                    üìà Ajusta los par√°metros y presiona "Simular" para generar la gr√°fica
                </div>
            </div>
        </div>

        <div class="results-panel" id="results-panel-container">
          <div class="results-header">
            <h3>Resultados de la Simulaci√≥n</h3>
            <button class="btn" id="download-csv-btn">Descargar CSV</button>
          </div>
          <div class="results-content" id="results-content-area">
            <p>¬°Aqu√≠ podr√°s observar los resultados de la simulaci√≥n!</p>
          </div>
        </div>

      </div>
    </div>
  </div>
  
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <script src="/static/js/simulador.js"></script>
  
</body>
</html>