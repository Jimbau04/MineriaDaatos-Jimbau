<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador de Densidades</title>
  <link rel="stylesheet" href="/static/styles/style.css">
</head>

<body>

  <div class="encabezado text-center">
    <img src="/static/recursos/lapiz.png" alt="Logo" class="logo">
    <h1 style="text-align: center;">Simulador de Densidades</h1>
  </div>

  <div class="container">
    
    <nav class="sidebar">
      <div class="sidebar-title">Distribuciones</div>
      <button class="nav-item active" data-distribution="bernoulli">Bernoulli</button>
      <button class="nav-item" data-distribution="binomial">Binomial</button>
      <button class="nav-item" data-distribution="multinomial">Multinomial</button>
      <button class="nav-item" data-distribution="exponencial">Exponencial</button>
      <button class="nav-item" data-distribution="normal">Normal</button>
      <button class="nav-item" data-distribution="gibbs">Método de Gibbs</button>
      <button class="nav-item" data-distribution="normal-bivariada">Normal Bivariada</button>
    </nav>

    <div class="main-content">
      <div class="simulation-panel">
        <h2 class="panel-title" id="panelTitle">Distribución de Bernoulli</h2>

        <div class="distribution-content active" id="bernoulli">
          <div class="inputs-section">
            <div class="input-group">
              <label for="bernoulli-p">Probabilidad de éxito (p) (0-1):</label>
              <input type="number" id="bernoulli-p" min="0" max="1" step="0.01" value="0.5">
            </div>
            <div class="input-group">
              <label for="bernoulli-n">Número de simulaciones:</label>
              <input type="number" id="bernoulli-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="binomial">
          <div class="inputs-section">
            <div class="input-group">
              <label for="binomial-n">Número de ensayos (n):</label>
              <input type="number" id="binomial-n" min="1" value="10">
            </div>
            <div class="input-group">
              <label for="binomial-p">Probabilidad de éxito (p):</label>
              <input type="number" id="binomial-p" min="0" max="1" step="0.01" value="0.5">
            </div>
            <div class="input-group">
              <label for="binomial-sims">Número de simulaciones:</label>
              <input type="number" id="binomial-sims" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        
          <!-- Contenido para Multinomial -->
        <div class="distribution-content" id="multinomial">
          
          <div class="tabs">
            <button class="tab-button active" onclick="cambiarTab('simulacion')">Simulación Basica</button>
            <button class="tab-button" onclick="cambiarTab('probabilidad')">Distribucion Multinomial</button>
          </div>
          
          <div id="simulacion" class="tab-content active">
            <div class="main-grid">
              <div class="inputs-section">
                <div class="panel-title">Parámetros de Simulación</div>
                
                <div class="section">
                  <div class="input-group">
                    <label>Número de Experimentos</label>
                    <input type="number" id="n_experimentos" value="5000" min="1">
                  </div>
                </div>

                <div class="section">
                  <div class="section-header">Categorías y Probabilidades</div>
                  <div id="categories-container">
                    <div class="category-item" data-index="0">
                      <div class="category-header">
                        <span class="category-name">🔴 Categoria 1</span>
                        <button class="remove-btn" onclick="removeCategory(0)">✕</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Rojo">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.5" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                    <div class="category-item" data-index="1">
                      <div class="category-header">
                        <span class="category-name">🟢 Categoria 2</span>
                        <button class="remove-btn" onclick="removeCategory(1)">✕</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Verde">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.3" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                    <div class="category-item" data-index="2">
                      <div class="category-header">
                        <span class="category-name">🔵 Categoria 3</span>
                        <button class="remove-btn" onclick="removeCategory(2)">✕</button>
                      </div>
                      <div class="input-row">
                        <div class="input-group">
                          <label>Nombre</label>
                          <input type="text" class="cat-name" value="Azul">
                        </div>
                        <div class="input-group">
                          <label>Probabilidad</label>
                          <input type="number" class="cat-prob" value="0.2" min="0" max="1" step="0.01">
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="prob-sum-warning" class="prob-warning" style="display:none"></div>
                  <button class="add-category-btn" onclick="addCategory()">+ Añadir Categoría</button>
                </div>

                <button class="simulate-btn" onclick="simularMultinomial()">
                  🚀 Ejecutar Simulación
                </button>
              </div>

              <div class="panel results-panel">
                <div class="panel-title">📈 Resultados</div>
                <div id="placeholder-sim" class="placeholder">
                  Configure los parámetros y presione "Ejecutar Simulación"
                </div>
                <div id="resultados-sim" class="hidden"></div>
              </div>
            </div>
          </div>  

        <!-- TAB PROBABILIDAD -->
    <div id="probabilidad" class="tab-content">
      <div class="main-grid">
        <div class="inputs-section">
          <div class="panel-title">Configuración del Cálculo</div>
          
          <div class="section">
            <div class="input-group">
              <label>Número Total de Experimentos (n)</label>
              <input type="number" id="n_exp_prob" value="10" min="1">
            </div>
          </div>

          <div class="section">
            <div class="section-header">Configuración de Categorías</div>
            <div id="categories-prob-container">
              <div class="category-item" data-index="0">
                <div class="category-header">
                  <span class="category-name">Categoría 1</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">✕</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.3" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="3" min="0">
                  </div>
                </div>
              </div>
              <div class="category-item" data-index="1">
                <div class="category-header">
                  <span class="category-name">Categoría 2</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">✕</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.5" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="5" min="0">
                  </div>
                </div>
              </div>
              <div class="category-item" data-index="2">
                <div class="category-header">
                  <span class="category-name">Categoría 2</span>
                  <button class="remove-btn" onclick="removeCategoryProb(0)">✕</button>
                </div>
                <div class="input-row">
                  <div class="input-group">
                    <label>Nombre</label>
                    <input type="text" class="cat-name-prob" value="A">
                  </div>
                  <div class="input-group">
                    <label>Probabilidad (p)</label>
                    <input type="number" class="cat-prob-prob" value="0.2" min="0" max="1" step="0.01">
                  </div>
                  <div class="input-group">
                    <label>Frecuencia Deseada (k)</label>
                    <input type="number" class="cat-freq-prob" value="2" min="0">
                  </div>
                </div>
              </div>
            </div>
            <div id="prob-sum-warning-2" class="prob-warning" style="display:none"></div>
            <button class="add-category-btn" onclick="addCategoryProb()">+ Añadir Categoría</button>
          </div>

          <button class="simulate-btn" onclick="calcularProbabilidad()">
            🧮 Calcular Probabilidad
          </button>
          <button class="simulate-btn" style="background: linear-gradient(135deg, #27ae60, #229954); margin-top: 0.5rem;" onclick="verificarSimulacion()">
            ✓ Verificar con Simulación
          </button>
        </div>


        <div class="panel results-panel">
          <div class="panel-title">🎯 Resultados del Cálculo</div>
          <div id="placeholder-prob" class="placeholder">
            Configure los parámetros y presione "Calcular Probabilidad"
          </div>
          <div id="resultados-prob" class="hidden"></div>
        </div>
      </div>
    </div>
        </div>
        
      
    

        <!-- Contenido para Exponencial -->
        <div class="distribution-content" id="exponencial">
          <div class="inputs-section">
            <div class="input-group">
              <label for="exponencial-lambda">Parámetro λ (tasa):</label>
              <input type="number" id="exponencial-lambda" min="0.01" step="0.01" value="1">
            </div>
            <div class="input-group">
              <label for="exponencial-n">Número de simulaciones:</label>
              <input type="number" id="exponencial-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="normal">
          <div class="inputs-section">
            <div class="input-group">
              <label for="normal-mu">Media (μ):</label>
              <input type="number" id="normal-mu" step="0.01" value="0">
            </div>
            <div class="input-group">
              <label for="normal-sigma">Desviación estándar (σ):</label>
              <input type="number" id="normal-sigma" min="0.01" step="0.01" value="1">
            </div>
            <div class="input-group">
              <label for="normal-n">Número de simulaciones:</label>
              <input type="number" id="normal-n" min="1" value="1000">
            </div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="gibbs">
          <div class="inputs-section">
            <div class="input-group">
              <label for="gibbs-function-select">Selecciona una función de densidad f(x, y):</label>
              <select id="gibbs-function-select" class="input-group input"></select>
            </div>

            <div class="input-group">
                <label>Límites del Dominio (No editables):</label>
                <div class="bounds-display-grid">
                    <div>
                        <span>X Mín:</span>
                        <code id="gibbs-bound-xmin">0</code>
                    </div>
                    <div>
                        <span>X Máx:</span>
                        <code id="gibbs-bound-xmax">0</code>
                    </div>
                    <div>
                        <span>Y Mín:</span>
                        <code id="gibbs-bound-ymin">0</code>
                    </div>
                    <div>
                        <span>Y Máx:</span>
                        <code id="gibbs-bound-ymax">0</code>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>Valores iniciales (opcional):</label>
                <div class="bounds-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <input type="number" id="gibbs-x-initial" placeholder="x inicial (auto)">
                    <input type="number" id="gibbs-y-initial" placeholder="y inicial (auto)">
                </div>
            </div>

            <div class="bounds-grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div class="input-group">
                    <label for="gibbs-n-samples">Número de muestras:</label>
                    <input type="number" id="gibbs-n-samples" value="2000" min="100">
                </div>
                <div class="input-group">
                    <label for="gibbs-burn-in">Burn-in:</label>
                    <input type="number" id="gibbs-burn-in" value="500" min="0">
                </div>
            </div>
            
            <div id="gibbs-status" style="margin-top: 1rem;"></div>
          </div>

          <div class="buttons-section">
            <button class="btn-primary" id="gibbs-validate-btn">🔍 Validar</button>
            <button class="btn-primary" id="gibbs-sample-btn" disabled>Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="distribution-content" id="normal-bivariada">
          <div class="inputs-section">
            <div class="input-group"><label for="bivariada-mu-x">Media X (μₓ):</label><input type="number" id="bivariada-mu-x" step="0.1" value="0"></div>
            <div class="input-group"><label for="bivariada-mu-y">Media Y (μᵧ):</label><input type="number" id="bivariada-mu-y" step="0.1" value="0"></div>
            <div class="input-group"><label for="bivariada-sigma-x">Desviación X (σₓ):</label><input type="number" id="bivariada-sigma-x" min="0.01" step="0.1" value="1"></div>
            <div class="input-group"><label for="bivariada-sigma-y">Desviación Y (σᵧ):</label><input type="number" id="bivariada-sigma-y" min="0.01" step="0.1" value="1"></div>
            <div class="input-group"><label for="bivariada-rho">Correlación (ρ):</label><input type="number" id="bivariada-rho" min="-1" max="1" step="0.1" value="0.5"></div>
            <div class="input-group"><label for="bivariada-n">Número de simulaciones:</label><input type="number" id="bivariada-n" min="100" value="2000"></div>
          </div>
          <div class="buttons-section">
            <button class="btn-primary">Simular</button>
            <button class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div id="charts-container">
            <div class="chart-section" id="chart-secondary" style="display: none; height: 400px; margin-bottom: 1rem;"></div>
            <div class="chart-section" id="chart-main" style="min-height: 450px;">
                <div class="chart-placeholder">
                    📈 Ajusta los parámetros y presiona "Simular" para generar la gráfica
                </div>
            </div>
        </div>

        <div class="results-panel" id="results-panel-container">
          <div class="results-header">
            <h3>Resultados de la Simulación</h3>
            <button class="btn" id="download-csv-btn">Descargar CSV</button>
          </div>
          <div class="results-content" id="results-content-area">
            <p>¡Aquí podrás observar los resultados de la simulación!</p>
          </div>
        </div>

      </div>
    </div>
  </div>
  
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <script src="/static/js/simulador.js"></script>
  
</body>
</html>